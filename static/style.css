<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–∫–µ—Ç–∞ - –ö–ª—É–± –í–µ–¥—å–º</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <h1>üåô –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –ö–ª—É–±</h1>
            <p class="subtitle">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∫–µ—Ç—É</p>
        </header>

        <nav class="app-nav">
            <a href="/survey" class="nav-item active">
                <span class="nav-icon">üìù</span>
                <span class="nav-text">–ê–Ω–∫–µ—Ç–∞</span>
            </a>
            <a href="/" class="nav-item">
                <span class="nav-icon">üë•</span>
                <span class="nav-text">–£—á–∞—Å—Ç–Ω–∏—Ü—ã</span>
            </a>
            <a href="/profile" class="nav-item">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span class="nav-text">–ü—Ä–æ—Ñ–∏–ª—å</span>
            </a>
        </nav>

        <main class="app-main">
            <section class="form-section">
                <h2>üîÆ –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –ö–ª—É–±</h2>
                <form id="surveyForm" class="survey-form">
                    
                    <div class="form-group">
                        <label for="name">–í–∞—à–µ –∏–º—è</label>
                        <input type="text" id="name" name="name" required placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è">
                    </div>

                    <div class="form-group">
                        <label for="birthDate">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è (–î–î.–ú–ú–ú.–ì–ì–ì–ì)</label>
                        <input type="text" id="birthDate" name="birthDate" placeholder="01.01.1990">
                    </div>

                    <div class="form-group">
                        <label for="status">–°–µ–º–µ–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ</label>
                        <select id="status" name="status" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç—É—Å</option>
                            <option value="married">–ó–∞–º—É–∂–µ–º</option>
                            <option value="single">–°–≤–æ–±–æ–¥–Ω–∞</option>
                            <option value="divorced">–†–∞–∑–≤–µ–¥–µ–Ω–∞</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="children">–î–µ—Ç–∏ (–≤–æ–∑—Ä–∞—Å—Ç, –ø–æ–ª)</label>
                        <input type="text" id="children" name="children" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Å—ã–Ω 10–ª, –¥–æ—á—å 7–ª">
                    </div>

                    <div class="form-group">
                        <label for="interests">–£–≤–ª–µ—á–µ–Ω–∏—è –∏ —Ö–æ–±–±—ñ</label>
                        <textarea id="interests" name="interests" rows="3" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–∞—Ö..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="topics">–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ç–µ–º–∏ (–ú–ö, –≤—ã–∑–µ–¥—ã)</label>
                        <textarea id="topics" name="topics" rows="3" placeholder="–ö–∞–∫–∏–µ —Ç–µ–º—ã –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="goal">–¶–µ–ª—å –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ –∫–ª—É–±</label>
                        <textarea id="goal" name="goal" rows="3" placeholder="–ß–µ–≥–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ –¥–æ–±–∏—Ç—å—Å—è..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="source">–û—Ç–∫—É–¥–∞ —É–∑–Ω–∞–ª–∏ –æ –∫–ª—É–±–µ?</label>
                        <input type="text" id="source" name="source" placeholder="–û—Ç –ø–æ–¥—Ä—É–≥–∏, –∏–∑ —Å–æ—Ü—Å–µ—Ç–µ–π –∏ —Ç.–¥.">
                    </div>

                    <button type="submit" class="btn-submit">‚ú® –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∞–Ω–∫–µ—Ç—É</button>
                </form>
            </section>
        </main>
    </div>

    <script>
        const tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            tg.expand();
        }

        document.getElementById('surveyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                name: document.getElementById('name').value,
                birthDate: document.getElementById('birthDate').value,
                status: document.getElementById('status').value,
                children: document.getElementById('children').value,
                interests: document.getElementById('interests').value,
                topics: document.getElementById('topics').value,
                goal: document.getElementById('goal').value,
                source: document.getElementById('source').value
            };

            try {
                const response = await fetch('/submit_survey', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    alert('‚ú® –ê–Ω–∫–µ—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∫–ª—É–±!');
                    setTimeout(() => window.location.href = '/', 1500);
                }
            } catch (error) {
                alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ');
            }
        });
    </script>
</body>
</html>
