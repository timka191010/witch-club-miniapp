<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–∫–µ—Ç–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üîÆ –ö–ª—É–± –í–µ–¥—å–º "–ü–æ –ú—ë—Ç–ª–∞–º"</h1>
            <p class="subtitle">–ó–∞–∫—Ä—ã—Ç–æ–µ –∂–µ–Ω—Å–∫–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ</p>
        </header>

        <nav class="navigation">
            <a href="/survey" class="nav-btn active">üìù –ê–Ω–∫–µ—Ç–∞</a>
            <a href="/" class="nav-btn">üë• –£—á–∞—Å—Ç–Ω–∏—Ü—ã</a>
            <a href="/profile" class="nav-btn">‚öôÔ∏è –ü—Ä–æ—Ñ–∏–ª—å</a>
        </nav>

        <section class="form-section">
            <h2>üìù –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∫–µ—Ç—É</h2>
            <form id="applicationForm" class="application-form">
                <div class="form-group">
                    <label for="name">–í–∞—à–µ –∏–º—è:</label>
                    <input type="text" id="name" name="name" required placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
                </div>

                <div class="form-group">
                    <label for="age">–í–æ–∑—Ä–∞—Å—Ç:</label>
                    <input type="number" id="age" name="age" required placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç">
                </div>

                <div class="form-group">
                    <label for="experience">–û–ø—ã—Ç –≤ –º–∞–≥–∏–∏ (–ª–µ—Ç):</label>
                    <input type="number" id="experience" name="experience" placeholder="0">
                </div>

                <div class="form-group">
                    <label for="specialty">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:</label>
                    <select id="specialty" name="specialty" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é</option>
                        <option value="tarot">–¢–∞—Ä–æ</option>
                        <option value="herbs">–¢—Ä–∞–≤–Ω–∏—á–µ—Å—Ç–≤–æ</option>
                        <option value="astrology">–ê—Å—Ç—Ä–æ–ª–æ–≥–∏—è</option>
                        <option value="energy">–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞</option>
                        <option value="other">–î—Ä—É–≥–æ–µ</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="about">–û —Å–µ–±–µ:</label>
                    <textarea id="about" name="about" rows="4" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ..."></textarea>
                </div>

                <div class="form-group checkbox">
                    <input type="checkbox" id="agree" name="agree" required>
                    <label for="agree">–Ø —Å–æ–≥–ª–∞—Å–µ–Ω(–∞) —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∫–ª—É–±–∞</label>
                </div>

                <button type="submit" class="btn-submit">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∞–Ω–∫–µ—Ç—É</button>
            </form>
        </section>
    </div>

    <script>
        const tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            tg.expand();
        }

        document.getElementById('applicationForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                name: document.getElementById('name').value,
                age: document.getElementById('age').value,
                experience: document.getElementById('experience').value,
                specialty: document.getElementById('specialty').value,
                about: document.getElementById('about').value
            };

            try {
                const response = await fetch('/submit_survey', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    alert('‚ú® –ê–Ω–∫–µ—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!');
                    document.getElementById('applicationForm').reset();
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è');
            }
        });
    </script>
</body>
</html>
